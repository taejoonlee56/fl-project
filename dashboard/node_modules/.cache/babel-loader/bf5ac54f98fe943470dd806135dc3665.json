{"ast":null,"code":"\"use strict\";\n\nvar _classCallCheck = require(\"/home/tj/fl-carla/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\n\nvar _createClass = require(\"/home/tj/fl-carla/node_modules/@babel/runtime/helpers/createClass.js\").default;\n\nvar _inherits = require(\"/home/tj/fl-carla/node_modules/@babel/runtime/helpers/inherits.js\").default;\n\nvar _createSuper = require(\"/home/tj/fl-carla/node_modules/@babel/runtime/helpers/createSuper.js\").default;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Transport = void 0;\n\nvar events_1 = require(\"events\");\n\nvar parser_v4 = require(\"engine.io-parser\");\n\nvar parser_v3 = require(\"./parser-v3/index\");\n\nvar debug_1 = require(\"debug\");\n\nvar debug = (0, debug_1.default)(\"engine:transport\");\n/**\n * Noop function.\n *\n * @api private\n */\n\nfunction noop() {}\n\nvar Transport = /*#__PURE__*/function (_events_1$EventEmitte) {\n  _inherits(Transport, _events_1$EventEmitte);\n\n  var _super = _createSuper(Transport);\n\n  /**\n   * Transport constructor.\n   *\n   * @param {http.IncomingMessage} request\n   * @api public\n   */\n  function Transport(req) {\n    var _this;\n\n    _classCallCheck(this, Transport);\n\n    _this = _super.call(this);\n    _this.readyState = \"open\";\n    _this.discarded = false;\n    _this.protocol = req._query.EIO === \"4\" ? 4 : 3; // 3rd revision by default\n\n    _this.parser = _this.protocol === 4 ? parser_v4 : parser_v3;\n    return _this;\n  }\n\n  _createClass(Transport, [{\n    key: \"readyState\",\n    get: function get() {\n      return this._readyState;\n    },\n    set: function set(state) {\n      debug(\"readyState updated from %s to %s (%s)\", this._readyState, state, this.name);\n      this._readyState = state;\n    }\n    /**\n     * Flags the transport as discarded.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"discard\",\n    value: function discard() {\n      this.discarded = true;\n    }\n    /**\n     * Called with an incoming HTTP request.\n     *\n     * @param {http.IncomingMessage} request\n     * @api protected\n     */\n\n  }, {\n    key: \"onRequest\",\n    value: function onRequest(req) {\n      debug(\"setting request\");\n      this.req = req;\n    }\n    /**\n     * Closes the transport.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"close\",\n    value: function close(fn) {\n      if (\"closed\" === this.readyState || \"closing\" === this.readyState) return;\n      this.readyState = \"closing\";\n      this.doClose(fn || noop);\n    }\n    /**\n     * Called with a transport error.\n     *\n     * @param {String} message error\n     * @param {Object} error description\n     * @api protected\n     */\n\n  }, {\n    key: \"onError\",\n    value: function onError(msg, desc) {\n      if (this.listeners(\"error\").length) {\n        var err = new Error(msg); // @ts-ignore\n\n        err.type = \"TransportError\"; // @ts-ignore\n\n        err.description = desc;\n        this.emit(\"error\", err);\n      } else {\n        debug(\"ignored transport error %s (%s)\", msg, desc);\n      }\n    }\n    /**\n     * Called with parsed out a packets from the data stream.\n     *\n     * @param {Object} packet\n     * @api protected\n     */\n\n  }, {\n    key: \"onPacket\",\n    value: function onPacket(packet) {\n      this.emit(\"packet\", packet);\n    }\n    /**\n     * Called with the encoded packet data.\n     *\n     * @param {String} data\n     * @api protected\n     */\n\n  }, {\n    key: \"onData\",\n    value: function onData(data) {\n      this.onPacket(this.parser.decodePacket(data));\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @api protected\n     */\n\n  }, {\n    key: \"onClose\",\n    value: function onClose() {\n      this.readyState = \"closed\";\n      this.emit(\"close\");\n    }\n  }]);\n\n  return Transport;\n}(events_1.EventEmitter);\n\nexports.Transport = Transport;","map":{"version":3,"sources":["/home/tj/fl-carla/node_modules/engine.io/build/transport.js"],"names":["Object","defineProperty","exports","value","Transport","events_1","require","parser_v4","parser_v3","debug_1","debug","default","noop","req","readyState","discarded","protocol","_query","EIO","parser","_readyState","state","name","fn","doClose","msg","desc","listeners","length","err","Error","type","description","emit","packet","data","onPacket","decodePacket","EventEmitter"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Transport = void 0;\nconst events_1 = require(\"events\");\nconst parser_v4 = require(\"engine.io-parser\");\nconst parser_v3 = require(\"./parser-v3/index\");\nconst debug_1 = require(\"debug\");\nconst debug = (0, debug_1.default)(\"engine:transport\");\n/**\n * Noop function.\n *\n * @api private\n */\nfunction noop() { }\nclass Transport extends events_1.EventEmitter {\n    /**\n     * Transport constructor.\n     *\n     * @param {http.IncomingMessage} request\n     * @api public\n     */\n    constructor(req) {\n        super();\n        this.readyState = \"open\";\n        this.discarded = false;\n        this.protocol = req._query.EIO === \"4\" ? 4 : 3; // 3rd revision by default\n        this.parser = this.protocol === 4 ? parser_v4 : parser_v3;\n    }\n    get readyState() {\n        return this._readyState;\n    }\n    set readyState(state) {\n        debug(\"readyState updated from %s to %s (%s)\", this._readyState, state, this.name);\n        this._readyState = state;\n    }\n    /**\n     * Flags the transport as discarded.\n     *\n     * @api private\n     */\n    discard() {\n        this.discarded = true;\n    }\n    /**\n     * Called with an incoming HTTP request.\n     *\n     * @param {http.IncomingMessage} request\n     * @api protected\n     */\n    onRequest(req) {\n        debug(\"setting request\");\n        this.req = req;\n    }\n    /**\n     * Closes the transport.\n     *\n     * @api private\n     */\n    close(fn) {\n        if (\"closed\" === this.readyState || \"closing\" === this.readyState)\n            return;\n        this.readyState = \"closing\";\n        this.doClose(fn || noop);\n    }\n    /**\n     * Called with a transport error.\n     *\n     * @param {String} message error\n     * @param {Object} error description\n     * @api protected\n     */\n    onError(msg, desc) {\n        if (this.listeners(\"error\").length) {\n            const err = new Error(msg);\n            // @ts-ignore\n            err.type = \"TransportError\";\n            // @ts-ignore\n            err.description = desc;\n            this.emit(\"error\", err);\n        }\n        else {\n            debug(\"ignored transport error %s (%s)\", msg, desc);\n        }\n    }\n    /**\n     * Called with parsed out a packets from the data stream.\n     *\n     * @param {Object} packet\n     * @api protected\n     */\n    onPacket(packet) {\n        this.emit(\"packet\", packet);\n    }\n    /**\n     * Called with the encoded packet data.\n     *\n     * @param {String} data\n     * @api protected\n     */\n    onData(data) {\n        this.onPacket(this.parser.decodePacket(data));\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @api protected\n     */\n    onClose() {\n        this.readyState = \"closed\";\n        this.emit(\"close\");\n    }\n}\nexports.Transport = Transport;\n"]},"metadata":{},"sourceType":"script"}