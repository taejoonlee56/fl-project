{"ast":null,"code":"import _asyncToGenerator from \"/home/tj/fl-carla/dashboard/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _regeneratorRuntime from \"/home/tj/fl-carla/dashboard/node_modules/@babel/runtime/regenerator/index.js\";\nimport { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport { login, signUp, resetPassword, verifySecurityCode, setNewPassword } from '@app/api/auth.api';\nimport { setUser } from '@app/store/slices/userSlice';\nimport { deleteToken, deleteUser, persistToken, readToken } from '@app/services/localStorage.service';\nvar initialState = {\n  token: readToken()\n};\nexport var doLogin = createAsyncThunk('auth/doLogin', /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(loginPayload, _ref) {\n    var dispatch;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            dispatch = _ref.dispatch;\n            return _context.abrupt(\"return\", login(loginPayload).then(function (res) {\n              dispatch(setUser(res.user));\n              persistToken(res.token);\n              return res.token;\n            }));\n\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x, _x2) {\n    return _ref2.apply(this, arguments);\n  };\n}());\nexport var doSignUp = createAsyncThunk('auth/doSignUp', /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(signUpPayload) {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            return _context2.abrupt(\"return\", signUp(signUpPayload));\n\n          case 1:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x3) {\n    return _ref3.apply(this, arguments);\n  };\n}());\nexport var doResetPassword = createAsyncThunk('auth/doResetPassword', /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(resetPassPayload) {\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            return _context3.abrupt(\"return\", resetPassword(resetPassPayload));\n\n          case 1:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function (_x4) {\n    return _ref4.apply(this, arguments);\n  };\n}());\nexport var doVerifySecurityCode = createAsyncThunk('auth/doVerifySecurityCode', /*#__PURE__*/function () {\n  var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(securityCodePayload) {\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            return _context4.abrupt(\"return\", verifySecurityCode(securityCodePayload));\n\n          case 1:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n\n  return function (_x5) {\n    return _ref5.apply(this, arguments);\n  };\n}());\nexport var doSetNewPassword = createAsyncThunk('auth/doSetNewPassword', /*#__PURE__*/function () {\n  var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(newPasswordData) {\n    return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            return _context5.abrupt(\"return\", setNewPassword(newPasswordData));\n\n          case 1:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n\n  return function (_x6) {\n    return _ref6.apply(this, arguments);\n  };\n}());\nexport var doLogout = createAsyncThunk('auth/doLogout', function (payload, _ref7) {\n  var dispatch = _ref7.dispatch;\n  deleteToken();\n  deleteUser();\n  dispatch(setUser(null));\n});\nvar authSlice = createSlice({\n  name: 'auth',\n  initialState: initialState,\n  reducers: {},\n  extraReducers: function extraReducers(builder) {\n    builder.addCase(doLogin.fulfilled, function (state, action) {\n      state.token = action.payload;\n    });\n    builder.addCase(doLogout.fulfilled, function (state) {\n      state.token = '';\n    });\n  }\n});\nexport default authSlice.reducer;","map":{"version":3,"sources":["/home/tj/fl-carla/dashboard/src/store/slices/authSlice.ts"],"names":["createAsyncThunk","createSlice","login","signUp","resetPassword","verifySecurityCode","setNewPassword","setUser","deleteToken","deleteUser","persistToken","readToken","initialState","token","doLogin","loginPayload","dispatch","then","res","user","doSignUp","signUpPayload","doResetPassword","resetPassPayload","doVerifySecurityCode","securityCodePayload","doSetNewPassword","newPasswordData","doLogout","payload","authSlice","name","reducers","extraReducers","builder","addCase","fulfilled","state","action","reducer"],"mappings":"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","sourcesContent":["import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport {\n  ResetPasswordRequest,\n  login,\n  LoginRequest,\n  signUp,\n  SignUpRequest,\n  resetPassword,\n  verifySecurityCode,\n  SecurityCodePayload,\n  NewPasswordData,\n  setNewPassword,\n} from '@app/api/auth.api';\nimport { setUser } from '@app/store/slices/userSlice';\nimport { deleteToken, deleteUser, persistToken, readToken } from '@app/services/localStorage.service';\n\nexport interface AuthSlice {\n  token: string | null;\n}\n\nconst initialState: AuthSlice = {\n  token: readToken(),\n};\n\nexport const doLogin = createAsyncThunk('auth/doLogin', async (loginPayload: LoginRequest, { dispatch }) =>\n  login(loginPayload).then((res) => {\n    dispatch(setUser(res.user));\n    persistToken(res.token);\n\n    return res.token;\n  }),\n);\n\nexport const doSignUp = createAsyncThunk('auth/doSignUp', async (signUpPayload: SignUpRequest) =>\n  signUp(signUpPayload),\n);\n\nexport const doResetPassword = createAsyncThunk(\n  'auth/doResetPassword',\n  async (resetPassPayload: ResetPasswordRequest) => resetPassword(resetPassPayload),\n);\n\nexport const doVerifySecurityCode = createAsyncThunk(\n  'auth/doVerifySecurityCode',\n  async (securityCodePayload: SecurityCodePayload) => verifySecurityCode(securityCodePayload),\n);\n\nexport const doSetNewPassword = createAsyncThunk('auth/doSetNewPassword', async (newPasswordData: NewPasswordData) =>\n  setNewPassword(newPasswordData),\n);\n\nexport const doLogout = createAsyncThunk('auth/doLogout', (payload, { dispatch }) => {\n  deleteToken();\n  deleteUser();\n  dispatch(setUser(null));\n});\n\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(doLogin.fulfilled, (state, action) => {\n      state.token = action.payload;\n    });\n    builder.addCase(doLogout.fulfilled, (state) => {\n      state.token = '';\n    });\n  },\n});\n\nexport default authSlice.reducer;\n"]},"metadata":{},"sourceType":"module"}